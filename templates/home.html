<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zyzor Scanner - Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Sekuya&family=Rammetto+One&family=Badeen+Display&family=Rubik+Mono+One&family=Yanone+Kaffeesatz:wght@200..700&display=swap"
        rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bungee&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">

    <style>
        .control-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 20px;
        }

        .control-wrapper {
            display: flex;
            gap: 15px;
            align-items: stretch;
            width: 100%;
        }

        .control-note {
            color: rgba(255, 255, 255, 0.6);
            font-style: italic;
            font-size: 0.85rem;
            margin-top: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .control-wrapper {
                flex-direction: column;
                gap: 15px;
            }

            #preset-dropdown,
            #submit-btn {
                flex: 1 1 auto;
                width: 100% !important;
                padding: 1rem !important;
                /* Larger touch target */
                font-size: 1rem !important;
            }
        }
    </style>
</head>

<body class="home">
    <canvas id="miCanvas"></canvas>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-left">
            <span class="logo">
                <img src="{{ url_for('static', filename='logo.png') }}" alt="Zyzor Logo" class="logo-icon">
                <span class="logo-text rubik-mono-one-regular">Zyzor Scanner</span>
            </span>
            <div class="quote-floating">Predict. Protect. Prevail.</div>
        </div>
        <div class="nav-right">
            <a href="/" class="nav-link" title="Home" aria-label="Home">
                <!-- Home icon -->
                <svg class="nav-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"
                    focusable="false">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" fill="currentColor" />
                </svg>
            </a>
            <a href="/home" class="nav-link" title="Checker" aria-label="Checker">
                <!-- Blue shield icon (matches Security Intelligence Hub) -->
                <svg class="nav-icon icon-blue" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"
                    aria-hidden="true" focusable="false">
                    <path d="M12 2l8 4v6c0 5-3.9 9.7-8 10-4.1-.3-8-5-8-10V6l8-4z" />
                </svg>
            </a>
        </div>
    </nav>

    <!-- Main Checker Section -->
    <section class="checker-section">
        <div class="cyber-grid"></div>

        <div class="checker-container">
            <div class="checker-header">
                <h2 class="bungee-regular">Zyzor Request Checker</h2>
                <p>Enter your request below to analyze potential security threats using our advanced AI detection
                    system.</p>
            </div>

            <div class="input-group">
                <textarea id="user-input"
                    placeholder="Paste Raw HTTP Request here (e.g. from Burp Suite)...&#10;POST /login HTTP/1.1&#10;Host: example.com&#10;..."
                    rows="8" class="cyber-input" spellcheck="false"></textarea>

                <div class="control-container">
                    <div class="control-wrapper">
                        <select id="preset-dropdown" class="cyber-input"
                            style="flex: 7; padding: 0.875rem 1rem; cursor: pointer; background-color: #050510; color: #00f3ff; border: 2px solid #00f3ff; border-radius: 8px; font-family: inherit; font-size: 1rem; outline: none; transition: all 0.3s ease;">
                            <option value="" disabled selected style="color: #888;">üëá Select an Attack Payload (No
                                Input? Use this)</option>
                            <option value="sqli_url" style="color: #00f3ff; background: #050510;">SQL Injection
                                (One-Line)</option>
                            <option value="sqli_raw" style="color: #00f3ff; background: #050510;">SQL Injection (Raw
                                HTTP)</option>
                            <option value="xss_url" style="color: #00f3ff; background: #050510;">XSS (One-Line)</option>
                            <option value="xss_raw" style="color: #00f3ff; background: #050510;">XSS (Raw HTTP)</option>
                            <option value="csrf" style="color: #00f3ff; background: #050510;">CSRF (POST)</option>
                            <option value="idor_url" style="color: #00f3ff; background: #050510;">IDOR (One-Line)
                            </option>
                            <option value="idor_raw" style="color: #00f3ff; background: #050510;">IDOR (Raw HTTP)
                            </option>
                            <option value="dom" style="color: #00f3ff; background: #050510;">DOM-based XSS</option>
                            <option value="ssrf_url" style="color: #00f3ff; background: #050510;">SSRF (One-Line)
                            </option>
                            <option value="ssrf_json" style="color: #00f3ff; background: #050510;">SSRF (JSON Body)
                            </option>
                            <option value="cache_poison" style="color: #00f3ff; background: #050510;">Web Cache
                                Poisoning</option>
                            <option value="smuggling" style="color: #00f3ff; background: #050510;">HTTP Request
                                Smuggling</option>
                            <option value="deserialization" style="color: #00f3ff; background: #050510;">Insecure
                                Deserialization/RCE</option>
                            <option value="llm_url" style="color: #00f3ff; background: #050510;">Web LLM Attack
                                (One-Line)</option>
                            <option value="llm_json" style="color: #00f3ff; background: #050510;">Web LLM Attack (JSON)
                            </option>
                            <option value="host_header" style="color: #00f3ff; background: #050510;">HTTP Host Header
                                Attack</option>
                            <option value="equifax" style="color: #00f3ff; background: #050510;">Equifax Style (Complex)
                            </option>
                        </select>
                        <button class="neon-btn" id="submit-btn"
                            style="flex: 2; padding: 0.875rem 2.5rem; white-space: nowrap;">Analyze</button>
                    </div>
                    <small class="control-note">
                        <span style="color: #00f3ff;">‚ÑπÔ∏è</span> Only use this dropdown if you don't have a specific
                        request to input.
                    </small>

                    <!-- New Attack Info Dropdown -->
                    <div class="control-wrapper" style="margin-top: 10px;">
                        <select id="info-dropdown" class="cyber-input"
                            style="width: 100%; padding: 0.875rem 1rem; cursor: pointer; background-color: #050510; color: #ff00ff; border: 2px solid #ff00ff; border-radius: 8px; font-family: inherit; font-size: 1rem; outline: none; transition: all 0.3s ease;">
                            <option value="" disabled selected style="color: #888;">ü§î No idea about any attack? Click
                                me!</option>
                            <option value="sqli" style="color: #ff00ff; background: #050510;">SQL Injection</option>
                            <option value="xss" style="color: #ff00ff; background: #050510;">XSS (Cross-Site Scripting)
                            </option>
                            <option value="csrf" style="color: #ff00ff; background: #050510;">CSRF (Cross-Site Request
                                Forgery)</option>
                            <option value="idor" style="color: #ff00ff; background: #050510;">IDOR (Insecure Direct
                                Object References)</option>
                            <option value="ssrf" style="color: #ff00ff; background: #050510;">SSRF (Server-Side Request
                                Forgery)</option>
                            <option value="rce" style="color: #ff00ff; background: #050510;">Command Injection / RCE
                            </option>
                            <option value="lfi" style="color: #ff00ff; background: #050510;">Path Traversal / LFI
                            </option>
                            <option value="nosql" style="color: #ff00ff; background: #050510;">NoSQL Injection</option>
                            <option value="ldap" style="color: #ff00ff; background: #050510;">LDAP Injection</option>
                            <option value="poison" style="color: #ff00ff; background: #050510;">Web Cache Poisoning
                            </option>
                            <option value="smuggling" style="color: #ff00ff; background: #050510;">HTTP Request
                                Smuggling</option>
                            <option value="deserialization" style="color: #ff00ff; background: #050510;">Insecure
                                Deserialization</option>
                            <option value="llm" style="color: #ff00ff; background: #050510;">Web LLM Injection</option>
                            <option value="host_header" style="color: #ff00ff; background: #050510;">HTTP Host Header
                                Attack</option>
                        </select>
                    </div>

                    <!-- Info Display Area -->
                    <div id="attack-info-display"
                        style="display: none; background: rgba(5, 5, 16, 0.9); border: 1px solid #ff00ff; border-radius: 8px; padding: 15px; margin-top: 10px; color: #fff;">
                        <h4 id="info-title" style="color: #ff00ff; margin-top: 0; margin-bottom: 10px;"></h4>
                        <p id="info-desc" style="font-size: 0.95rem; line-height: 1.5; margin-bottom: 10px;"></p>
                        <div
                            style="background: #111; padding: 10px; border-radius: 4px; border-left: 3px solid #ff00ff;">
                            <small style="color: #aaa; display: block; margin-bottom: 5px;">EXAMPLE:</small>
                            <code id="info-example" style="font-family: monospace; color: #00ff00;"></code>
                        </div>
                    </div>
                </div>
            </div>

            <div id="loading" class="hidden">
                <div class="loading-spinner"></div>
                Analyzing request pattern & reputation...
            </div>

            <!-- Dashboard Result Container -->
            <div id="dashboard-result" class="hidden">
                <div class="dashboard-grid">
                    <!-- Left: Original Request with Highlighting -->
                    <div class="panel raw-panel">
                        <div class="panel-header">
                            <h3>üîç Smart Inspector</h3>
                            <span class="badge">Raw Input</span>
                        </div>
                        <div class="code-window" id="raw-content-view">
                            <!-- JS will inject spans here -->
                        </div>
                    </div>

                    <!-- Right: Analysis Report -->
                    <div class="panel report-panel">
                        <div class="panel-header">
                            <h3>üõ°Ô∏è Security Report</h3>
                            <span id="threat-score-badge" class="badge" style="display: none;">Score: --</span>
                        </div>
                        <div id="report-content">
                            <!-- JS populates this -->
                        </div>
                    </div>
                </div>

            </div>

            <!-- End of main content area, scripts follow -->
            <script src="{{ url_for('static', filename='starfield.js') }}" defer></script>
            <script src="{{ url_for('static', filename='home.js') }}?v=2" defer></script>
</body>

</html>